<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rebate Optimizer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar: Configuration -->
        <aside class="sidebar">
            <div class="logo">
                <h1>Rebate<span>Sim</span></h1>
            </div>

            <div class="config-section">
                <h2>Optimization Settings</h2>

                <div class="control-group">
                    <label>Elasticity Source</label>
                    <div class="toggle-group">
                        <label class="radio-label">
                            <input type="radio" name="elasticity-mode" value="manual" checked> Manual
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="elasticity-mode" value="ml"> ML Model
                        </label>
                    </div>
                </div>

                <div class="control-group" id="manual-elasticity-group">
                    <label for="elasticity">Revenue Elasticity</label>
                    <input type="range" id="elasticity" min="0.1" max="5.0" step="0.1" value="2.0">
                    <span id="elasticity-val">2.0</span>
                    <p class="help-text">Higher elasticity = Rebates drive more growth.</p>
                </div>

                <div class="control-group">
                    <label>Volume Thresholds</label>
                    <div class="help-text">Enter comma-separated values (e.g., 5000, 15000, 30000, 50000)</div>
                    <input type="text" id="vol-bins-input" class="text-input" value="5000, 15000, 30000, 50000">
                </div>

                <div class="control-group">
                    <label>Growth Thresholds</label>
                    <div class="help-text">Enter comma-separated decimals (e.g., 0.08, 0.15, 0.20)</div>
                    <input type="text" id="growth-bins-input" class="text-input" value="0.08, 0.15, 0.20">
                </div>

                <button id="run-btn" class="primary-btn">Run Optimization</button>
            </div>
        </aside>

        <!-- Main Content: Results -->
        <main class="main-content">
            <header>
                <h2>Simulation Results</h2>
                <div class="status" id="status-indicator">Ready</div>
            </header>

            <div class="main-content">
                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab-btn active" data-tab="optimizer">Optimizer</button>
                    <button class="tab-btn" data-tab="calculator">Static Calculator</button>
                </div>

                <!-- Optimizer Tab -->
                <div id="optimizer" class="tab-content active">
                    <div class="kpi-grid">
                        <div class="kpi-card">
                            <h3>Projected Revenue</h3>
                            <div class="value" id="max-revenue">$0</div>
                            <div class="subtitle">Optimized Scenario</div>
                        </div>
                        <div class="kpi-card">
                            <h3>Baseline Revenue</h3>
                            <div class="value" id="baseline-revenue">$0</div>
                            <div class="subtitle">Current State</div>
                        </div>
                        <div class="kpi-card">
                            <h3>Revenue Uplift</h3>
                            <div class="value highlight" id="revenue-uplift">$0</div>
                            <div class="subtitle">Net Gain</div>
                        </div>
                    </div>

                    <div class="results-section">
                        <h3>Optimized Rebate Grid</h3>
                        <div class="table-container">
                            <table id="results-table">
                                <thead>
                                    <!-- Headers injected by JS -->
                                </thead>
                                <tbody>
                                    <!-- Rows injected by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Calculator Tab -->
                <div id="calculator" class="tab-content">
                    <div class="control-panel" style="margin-bottom: 1rem;">
                        <h3>Manual Grid Input</h3>
                        <p class="help-text">Enter rebate percentages (e.g., 0.10 for 10%) for each tier.</p>
                        <button id="generate-grid-btn" class="primary-btn"
                            style="width: auto; margin-top: 0.5rem;">Generate/Reset Grid</button>
                    </div>

                    <div class="table-container">
                        <table id="input-grid-table">
                            <thead>
                                <!-- Headers injected by JS -->
                            </thead>
                            <tbody>
                                <!-- Input Rows injected by JS -->
                            </tbody>
                        </table>
                    </div>

                    <button id="calc-static-btn" class="primary-btn" style="margin-top: 1rem;">Calculate Cost</button>

                    <div class="kpi-grid" style="margin-top: 2rem;">
                        <div class="kpi-card">
                            <h3>Total Revenue</h3>
                            <div class="value" id="static-revenue">$0</div>
                            <div class="subtitle">Baseline</div>
                        </div>
                        <div class="kpi-card">
                            <h3>Total Rebate Cost</h3>
                            <div class="value" id="static-cost">$0</div>
                            <div class="subtitle">Based on Input Grid</div>
                        </div>
                        <div class="kpi-card">
                            <h3>Average Rate</h3>
                            <div class="value highlight" id="static-avg-rate">0%</div>
                            <div class="subtitle">Effective Rate</div>
                        </div>
                    </div>
                </div>
            </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>